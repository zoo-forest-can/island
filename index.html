<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è·¯å¦ç¾… â€” éŠæˆ²å¹³å°</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg:#080c1a; --surface:#0f1528; --card:#141b2e;
      --border:rgba(255,255,255,0.07); --orange:#FF8C2A;
      --text:#eef1f8; --muted:#6a7a9a;
    }
    *,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
    html{scroll-behavior:smooth;}
    body{background:var(--bg);color:var(--text);font-family:'Noto Sans TC',sans-serif;overflow-x:hidden;min-height:100vh;}
    nav{position:sticky;top:0;z-index:200;height:60px;background:rgba(8,12,26,0.92);
      backdrop-filter:blur(16px);border-bottom:1px solid var(--border);
      display:flex;align-items:center;justify-content:space-between;padding:0 36px;}
    .nav-brand{font-size:20px;font-weight:900;letter-spacing:4px;color:var(--orange);}
    .nav-links{display:flex;gap:28px;list-style:none;}
    .nav-links a{color:var(--muted);text-decoration:none;font-size:13px;font-weight:700;letter-spacing:1px;transition:color .2s;}
    .nav-links a:hover{color:var(--text);}
    /* BANNER */
    .banner{position:relative;width:100%;overflow:hidden;height:clamp(220px,40vw,480px);}
    .banner-img{width:100%;height:100%;object-fit:cover;object-position:center 30%;display:block;}
    .banner-fallback{width:100%;height:100%;background:linear-gradient(135deg,#0d1b3e 0%,#0a2a1a 25%,#1a3a0a 45%,#2d4a10 60%,#3d5a1a 75%,#1a2d40 100%);display:flex;align-items:center;justify-content:center;}
    .banner::after{content:'';position:absolute;inset:0;background:linear-gradient(to bottom,rgba(8,12,26,0) 0%,rgba(8,12,26,0.15) 60%,rgba(8,12,26,0.85) 100%);pointer-events:none;}
    .banner-text{position:absolute;bottom:32px;left:48px;z-index:2;}
    .banner-title{font-size:clamp(28px,4vw,52px);font-weight:900;letter-spacing:10px;
      background:linear-gradient(150deg,#FFD166 0%,#FF8C2A 45%,#FF5500 100%);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;line-height:1.1;margin-bottom:8px;}
    .banner-sub{font-size:13px;color:rgba(255,255,255,0.65);letter-spacing:4px;font-weight:500;}
    /* TAB BAR */
    .tab-bar{position:relative;z-index:10;display:flex;justify-content:center;gap:0;
      background:var(--surface);border-bottom:1px solid var(--border);}
    .tab-btn{background:none;border:none;color:var(--muted);font-family:inherit;font-size:14px;font-weight:700;
      letter-spacing:2px;padding:16px 48px;cursor:pointer;position:relative;transition:color .2s;outline:none;}
    .tab-btn::after{content:'';position:absolute;bottom:0;left:50%;transform:translateX(-50%);
      width:0;height:3px;background:var(--orange);border-radius:2px 2px 0 0;transition:width .25s;}
    .tab-btn.active{color:var(--text);}
    .tab-btn.active::after{width:60%;}
    .tab-btn:hover{color:var(--text);}
    /* SHARED */
    .wrap{position:relative;z-index:1;max-width:1080px;margin:0 auto;padding:64px 24px;}
    .sep{height:1px;background:var(--border);max-width:1080px;margin:0 auto;}
    .sec-title{text-align:center;font-size:22px;font-weight:900;letter-spacing:5px;margin-bottom:40px;}
    .sec-title em{color:var(--orange);font-style:normal;}
    /* GAMES */
    .game-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:24px;}
    .game-card{background:var(--card);border-radius:20px;overflow:hidden;border:1px solid var(--border);
      text-decoration:none;display:block;transition:transform .3s cubic-bezier(.34,1.56,.64,1),box-shadow .3s ease;}
    .game-card:hover{transform:translateY(-10px) scale(1.02);box-shadow:0 28px 52px rgba(0,0,0,.7);}
    .game-cover{width:100%;aspect-ratio:1;object-fit:cover;display:block;}
    .game-body{padding:22px 24px 26px;}
    .game-name{font-size:20px;font-weight:900;letter-spacing:1px;margin-bottom:8px;}
    .game-desc{font-size:13px;color:var(--muted);line-height:1.75;margin-bottom:18px;}
    .btn-go{display:inline-block;background:var(--orange);color:#000;font-weight:900;font-size:13px;
      letter-spacing:2px;padding:10px 28px;border-radius:100px;font-family:inherit;transition:opacity .2s,transform .15s;}
    .btn-go:hover{opacity:.88;transform:scale(1.05);}
    /* LEADERBOARD */
    .lb-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:24px;}
    .lb-panel{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:28px 24px;}
    .lb-panel-title{font-size:15px;font-weight:900;letter-spacing:1px;margin-bottom:20px;display:flex;align-items:center;gap:8px;}
    table{width:100%;border-collapse:collapse;}
    th{font-size:11px;color:var(--muted);font-weight:700;padding:6px 10px;border-bottom:1px solid var(--border);letter-spacing:1.5px;text-align:left;}
    td{padding:11px 10px;font-size:13px;border-bottom:1px solid rgba(255,255,255,0.04);}
    .td-rank{color:var(--muted);font-weight:700;width:36px;}
    .td-name{color:var(--text);}
    .td-score{color:var(--orange);font-weight:900;text-align:right;}
    .td-date{color:var(--muted);font-size:11px;text-align:right;}
    .lb-empty{text-align:center;color:var(--muted);padding:36px 0;font-size:13px;}
    .lb-note{text-align:center;margin-top:20px;color:var(--muted);font-size:12px;letter-spacing:1px;}
    .btn-rules{display:inline-block;background:transparent;color:var(--muted);font-weight:700;font-size:12px;
      letter-spacing:1px;padding:9px 18px;border-radius:100px;border:1px solid rgba(255,255,255,0.15);cursor:pointer;
      font-family:inherit;transition:all .2s;}
    .btn-rules:hover{color:var(--text);border-color:rgba(255,255,255,0.35);}
    .btn-actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap;}
    .play-count{font-size:11px;color:var(--muted);margin-bottom:12px;letter-spacing:1px;}
    .game-card-wrap{background:var(--card);border-radius:20px;overflow:hidden;border:1px solid var(--border);
      transition:transform .3s cubic-bezier(.34,1.56,.64,1),box-shadow .3s ease;}
    .game-card-wrap:hover{transform:translateY(-10px) scale(1.02);box-shadow:0 28px 52px rgba(0,0,0,.7);}
    .game-card-link{display:block;text-decoration:none;color:inherit;}
    /* Rules Modal */
    #rules-modal{display:none;position:fixed;inset:0;z-index:2000;background:rgba(0,0,0,0.82);
      align-items:center;justify-content:center;padding:24px;}
    #rules-modal.open{display:flex;}
    .rules-box{background:#141b2e;border-radius:20px;padding:32px 28px;max-width:420px;width:100%;
      border:1px solid rgba(255,200,50,0.25);position:relative;max-height:85vh;overflow-y:auto;}
    .rules-box h3{font-size:18px;font-weight:900;margin-bottom:20px;color:#FFD700;letter-spacing:2px;}
    .rule-item{display:flex;gap:10px;align-items:flex-start;padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.06);}
    .rule-icon{font-size:18px;flex-shrink:0;margin-top:1px;}
    .rule-text{font-size:13px;color:rgba(255,255,255,0.8);line-height:1.6;}
    .rules-close{margin-top:20px;width:100%;padding:12px;background:var(--orange);border:none;border-radius:12px;
      color:#000;font-weight:900;font-size:14px;cursor:pointer;font-family:inherit;letter-spacing:2px;}
    footer{position:relative;z-index:1;text-align:center;padding:44px 24px;color:var(--muted);font-size:13px;border-top:1px solid var(--border);}
    @media(max-width:860px){.banner-text{left:24px;bottom:24px;}}
    @media(max-width:560px){.game-grid,.lb-grid{grid-template-columns:1fr;}nav{padding:0 20px;}.nav-links{display:none;}.banner{height:200px;}}
  </style>
</head>
<body>

<nav>
  <div class="nav-brand">è·¯å¦ç¾…</div>
  <div id="nav-player" style="font-size:12px;color:rgba(255,255,255,0.7);font-weight:700;letter-spacing:1px;display:none;">ğŸ‘¤ <span id="nav-player-name"></span></div>
  <ul class="nav-links">
    <li><a href="#" onclick="switchTab('games');return false;">éŠæˆ²å¤§å»³</a></li>
    <li><a href="#" onclick="switchTab('lb');return false;">æ’è¡Œæ¦œ</a></li>
  </ul>
</nav>

<div class="banner">
  <img src="images/banner.jpg" alt="è·¯å¦ç¾…" class="banner-img"
       onerror="this.style.display='none';document.querySelector('.banner-fallback').style.display='flex'">
  <div class="banner-fallback" style="display:none">
    <div style="text-align:center;padding:0 24px;">
      <div style="font-size:64px;font-weight:900;letter-spacing:14px;background:linear-gradient(150deg,#FFD166,#FF8C2A);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">è·¯å¦ç¾…</div>
      <div style="font-size:13px;color:rgba(255,255,255,0.5);letter-spacing:6px;margin-top:8px;">ZOO FOREST ADVENTURE</div>
    </div>
  </div>
  <div class="banner-text">
    <div class="banner-title">è·¯å¦ç¾…</div>
    <div class="banner-sub">è‡ªç”±é«”é©—ï¼Œå‰µé€ æ­¡æ¨‚</div>
  </div>
</div>

<!-- TAB BAR -->
<div class="tab-bar">
  <button class="tab-btn active" id="tab-games" onclick="switchTab('games')">ğŸ® éŠæˆ²å¤§å»³</button>
  <button class="tab-btn" id="tab-lb" onclick="switchTab('lb')">ğŸ† æ’è¡Œæ¦œ</button>
</div>

<section id="section-games">
<section id="games" class="wrap">
  <h2 class="sec-title">éŠæˆ² <em>å¤§å»³</em></h2>
  <div class="game-grid">
    <div class="game-card-wrap">
      <a href="games/amhz.html" class="game-card-link">
        <img src="images/mix.png" alt="å‹•ç‰©åˆç›’æ¨‚" class="game-cover">
      </a>
      <div class="game-body">
        <div class="game-name">å‹•ç‰©åˆç›’æ¨‚</div>
        <div class="game-desc">ç–Šç–Šåˆé«”çš„ç”Ÿè‚–å°éŠæˆ²ï¼æŠŠå‹•ç‰©å¾€ä¸‹ä¸Ÿï¼Œè®“ç›¸åŒç”Ÿè‚–åˆé«”é€²åŒ–ï¼Œå †è¶Šé«˜åˆ†æ•¸è¶Šé«˜ï½</div>
        <div class="play-count" id="play-count-amhz">ğŸ® è¼‰å…¥ä¸­...</div>
        <div class="btn-actions">
          <a href="games/amhz.html" class="btn-go">ç«‹åˆ»æŒ‘æˆ° â–¶</a>
          <button class="btn-rules" onclick="showRules('amhz')">ç©æ³•èªªæ˜</button>
        </div>
      </div>
    </div>
    <div class="game-card-wrap">
      <a href="games/bb.html" class="game-card-link">
        <img src="images/homerun.png" alt="å‹•ç‰©è½Ÿä¸è®“" class="game-cover">
      </a>
      <div class="game-body">
        <div class="game-name">å‹•ç‰©è½Ÿä¸è®“</div>
        <div class="game-desc">ç”Ÿè‚–æ£’çƒå…¨å£˜æ‰“æŒ‘æˆ°ï¼é¸ä½ çš„ç”Ÿè‚–é¸æ‰‹ï¼ŒçŒ›æ‰“å…¨å£˜æ‰“ï¼Œ5å›åˆæ±ºä¸€å‹è² ï¼</div>
        <div class="play-count" id="play-count-bb">ğŸ® è¼‰å…¥ä¸­...</div>
        <div class="btn-actions">
          <a href="games/bb.html" class="btn-go">ç«‹åˆ»æŒ‘æˆ° â–¶</a>
          <button class="btn-rules" onclick="showRules('bb')">ç©æ³•èªªæ˜</button>
        </div>
      </div>
    </div>
  </div>
</section>
</section><!-- /section-games -->

<section id="section-lb" style="display:none">
<section id="lb" class="wrap">
  <h2 class="sec-title">ğŸ† é«˜æ‰‹ <em>æ’è¡Œæ¦œ</em></h2>
  <div class="lb-grid">
    <div class="lb-panel">
      <div class="lb-panel-title">ğŸ¯ å‹•ç‰©åˆç›’æ¨‚</div>
      <table>
        <thead><tr><th>åæ¬¡</th><th>ç©å®¶</th><th style="text-align:right">åˆ†æ•¸</th><th style="text-align:right">æ—¥æœŸ</th></tr></thead>
        <tbody id="leaderboard-amhz-body"></tbody>
      </table>
      <div id="leaderboard-amhz-empty" class="lb-empty" style="display:none">é‚„æ²’æœ‰é«˜æ‰‹è¨˜éŒ„ï¼Œå¿«å»æŒ‘æˆ°å§ï¼ğŸ®</div>
    </div>
    <div class="lb-panel">
      <div class="lb-panel-title">âš¾ å‹•ç‰©è½Ÿä¸è®“</div>
      <table>
        <thead><tr><th>åæ¬¡</th><th>ç©å®¶</th><th style="text-align:right">åˆ†æ•¸</th><th style="text-align:right">æ—¥æœŸ</th></tr></thead>
        <tbody id="leaderboard-bb-body"></tbody>
      </table>
      <div id="leaderboard-bb-empty" class="lb-empty" style="display:none">é‚„æ²’æœ‰é«˜æ‰‹è¨˜éŒ„ï¼Œå¿«å»æŒ‘æˆ°å§ï¼ğŸ®</div>
    </div>
  </div>
  <p class="lb-note">ğŸ“… æ’è¡Œæ¦œæ¯æœˆ 1 æ—¥è‡ªå‹•é‡ç½®</p>
</section>
</section><!-- /section-lb -->

<footer>Â© 2026 è·¯å¦ç¾… Â· å¿«æ¨‚éŠç©ï¼Œæ°¸é ç¬¬ä¸€ï¼</footer>

<script>
const FB_URL='https://zoo-forest-7132c-default-rtdb.asia-southeast1.firebasedatabase.app';

/* â”€â”€ éŠæˆ²è¨­å®šï¼ˆæ–°å¢éŠæˆ²åªéœ€åŠ æ­¤é™£åˆ—ï¼Œå…¶é¤˜è‡ªå‹•æ”¯æ´ï¼‰ â”€â”€ */
const GAMES_CONFIG = {
  amhz: {
    name: 'å‹•ç‰©åˆç›’æ¨‚',
    rules: [
      ['ğŸ¾','å¾ä¸Šæ–¹æŠ•ä¸‹å‹•ç‰©ï¼Œè®“ç›¸åŒç”Ÿè‚–åˆé«”é€²åŒ–ï¼'],
      ['ğŸ”¢','12ç¨®ç”Ÿè‚–ï¼Œè¶Šå¤§çš„å‹•ç‰©åˆ†æ•¸è¶Šé«˜ï¼'],
      ['âš ï¸','å‹•ç‰©å †ç–Šè¶…éç´…ç·šå³éŠæˆ²çµæŸ'],
      ['ğŸŒŸ','å¤©é™ç¥è¹Ÿï¼šç‰¹æ®Šäº‹ä»¶å¸¶ä¾†é©šå–œï¼'],
      ['ğŸ†','åˆé«”è¶Šå¤šï¼Œåˆ†æ•¸è¶Šé«˜ï¼Œè¡æ¦œï¼'],
    ]
  },
  bb: {
    name: 'å‹•ç‰©è½Ÿä¸è®“',
    rules: [
      ['ğŸ¯','æ¯å›åˆ10çƒï¼Œè¨ˆæ™‚æ®æ£’ï¼Œæ‰“å‡ºå…¨å£˜æ‰“ï¼'],
      ['âš¡','ç•Œå¤–çƒä¸æ‰£çƒæ•¸ï¼Œç¹¼çºŒæ‹šï¼'],
      ['ğŸ’ª','è§’è‰²åŠ›é‡è¶Šé«˜ï¼Œè¶Šå®¹æ˜“æ“Šå‡ºå…¨å£˜æ‰“'],
      ['ğŸ”„','10çƒå…¨å£˜æ‰“ â†’ é€²å…¥ä¸‹ä¸€å›åˆï¼Œæ›æ–°æŠ•æ‰‹'],
      ['ğŸ†','æœ€å¤š5å›åˆï¼Œé›£åº¦æ¯å›å‡ï¼'],
      ['âœ¨','é€£çºŒ10å…¨å£˜æ‰“ â†’ éš±è—é©šå–œï¼'],
    ]
  }
};

/* â”€â”€ ç§‘å­¸è¨˜è™Ÿæ ¼å¼åŒ– â”€â”€ */
function formatCount(n){
  if(n>=1000000) return (n/1000000).toFixed(1).replace(/\.0$/,'')+'M';
  if(n>=1000) return (n/1000).toFixed(1).replace(/\.0$/,'')+'K';
  return String(n);
}

/* â”€â”€ è®€å–å…¨å¹³å°éŠç©æ¬¡æ•¸ï¼ˆåƒ…è¼‰å…¥ä¸€æ¬¡ï¼Œç¯€çœ Firebase ç”¨é‡ï¼‰ â”€â”€ */
let _playCountCache = null;
async function loadPlayCount(){
  try{
    const r = await fetch(`${FB_URL}/playCount.json`);
    _playCountCache = (await r.json()) || 0;
    const label = 'ğŸ® ' + formatCount(_playCountCache) + ' æ¬¡éŠç©';
    document.querySelectorAll('[id^="play-count-"]').forEach(el=>{ el.textContent = label; });
  }catch(e){
    document.querySelectorAll('[id^="play-count-"]').forEach(el=>{ el.textContent = 'ğŸ® â€”'; });
  }
}

/* â”€â”€ ç©æ³•èªªæ˜ Modal â”€â”€ */
function showRules(gameId){
  const cfg = GAMES_CONFIG[gameId];
  if(!cfg) return;
  document.getElementById('rules-modal-title').textContent = 'ğŸ“– ' + cfg.name + ' ç©æ³•èªªæ˜';
  document.getElementById('rules-modal-content').innerHTML = cfg.rules.map(([icon,text])=>
    `<div class="rule-item"><span class="rule-icon">${icon}</span><span class="rule-text">${text}</span></div>`
  ).join('');
  document.getElementById('rules-modal').classList.add('open');
}
// é»æ“Š modal èƒŒæ™¯é—œé–‰
document.getElementById && window.addEventListener('DOMContentLoaded',()=>{
  document.getElementById('rules-modal').addEventListener('click',function(e){
    if(e.target===this) this.classList.remove('open');
  });
});

/* â”€â”€ é¡¯ç¤ºç©å®¶åç¨±æ–¼å°è¦½åˆ— â”€â”€ */
function showPlayerInNav(){
  const name = localStorage.getItem('platform_player_name');
  if(name){
    document.getElementById('nav-player-name').textContent = name;
    document.getElementById('nav-player').style.display = '';
  }
}
const MEDALS=['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰'];

async function checkMonthlyReset(){
  const now=new Date();
  const key='lb_last_reset';
  const lastReset=localStorage.getItem(key);
  const thisMonth=`${now.getFullYear()}-${now.getMonth()+1}`;
  if(lastReset!==thisMonth && now.getDate()===1){
    await Promise.all([
      fetch(`${FB_URL}/lb_amhz.json`,{method:'DELETE'}).catch(()=>{}),
      fetch(`${FB_URL}/lb_bb.json`,{method:'DELETE'}).catch(()=>{}),
    ]);
    localStorage.removeItem('platform_amhz_lb');
    localStorage.removeItem('platform_bb_lb');
    localStorage.setItem(key,thisMonth);
  }
}

function fmtDate(d){
  if(!d)return'â€”';
  const dt=new Date(d);
  if(isNaN(dt.getTime()))return d;
  return String(dt.getMonth()+1).padStart(2,'0')+'/'+String(dt.getDate()).padStart(2,'0');
}

async function fetchFirebaseLb(path){
  try{
    const res=await fetch(`${FB_URL}/${path}.json`);
    const data=await res.json();
    if(!data)return[];
    return Object.values(data).filter(e=>e&&e.score!=null).sort((a,b)=>b.score-a.score).slice(0,10);
  }catch{
    const key=path==='lb_amhz'?'platform_amhz_lb':'platform_bb_lb';
    try{return JSON.parse(localStorage.getItem(key)||'[]');}catch{return[];}
  }
}

function renderLb(data,tbodyId,emptyId){
  const tbody=document.getElementById(tbodyId);
  const empty=document.getElementById(emptyId);
  if(!data.length){tbody.innerHTML='';if(empty)empty.style.display='';return;}
  if(empty)empty.style.display='none';
  tbody.innerHTML=data.map((e,i)=>{
    const medal=MEDALS[i]||(i+1)+'.';
    return`<tr><td class="td-rank">${medal}</td><td class="td-name">${e.name||'åŒ¿åç©å®¶'}</td><td class="td-score">${e.score??e.s??'â€”'}</td><td class="td-date">${fmtDate(e.date||e.d)}</td></tr>`;
  }).join('');
}

async function loadAll(){
  const[amhz,bb]=await Promise.all([fetchFirebaseLb('lb_amhz'),fetchFirebaseLb('lb_bb')]);
  renderLb(amhz,'leaderboard-amhz-body','leaderboard-amhz-empty');
  renderLb(bb,'leaderboard-bb-body','leaderboard-bb-empty');
}

function switchTab(tab){
  const isGames = tab==='games';
  document.getElementById('section-games').style.display = isGames?'':'none';
  document.getElementById('section-lb').style.display   = isGames?'none':'';
  document.getElementById('tab-games').classList.toggle('active', isGames);
  document.getElementById('tab-lb').classList.toggle('active', !isGames);
  if(!isGames) loadAll();
}

document.addEventListener('DOMContentLoaded',async function(){
  await checkMonthlyReset();
  showPlayerInNav();
  loadPlayCount();
  loadAll();
  setInterval(loadAll,10000);
});
</script>
<!-- Rules Modal -->
<div id="rules-modal">
  <div class="rules-box">
    <h3 id="rules-modal-title">ç©æ³•èªªæ˜</h3>
    <div id="rules-modal-content"></div>
    <button class="rules-close" onclick="document.getElementById('rules-modal').classList.remove('open')">é—œé–‰</button>
  </div>
</div>
</body>
</html>
